
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI-Powered UPI Fraud Detection</title>

    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
    >
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />

    <style>
        body {
            background: radial-gradient(circle at top, #1e293b 0, #020617 55%, #020617 100%);
            color: #e5e7eb;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        /* üëÅÔ∏è Make ALL muted text bright + readable */
        .text-muted {
            color: #cbd5e1 !important;
        }

        /* helper text under inputs */
        .label-help {
            font-size: 0.8rem;
            color: #cbd5f5 !important;
        }

        /* left form labels */
        .form-label {
            color: #e2e8f0 !important;
            font-weight: 500;
        }

        /* section titles */
        .form-section-title {
            color: #94a3b8 !important;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.08em;
        }

        /* small text styles (Risk Score headers, etc.) */
        .small, small, .fw-semibold {
            color: #e2e8f0 !important;
        }

        /* card + UI panel styling */
        .card-main {
            background: rgba(15,23,42,0.96);
            border: 1px solid rgba(148,163,184,0.3);
            border-radius: 16px;
            box-shadow: 0 24px 60px rgba(15,23,42,0.7);
        }

        /* make forms readable */
        .form-control,
        .form-select {
            background: rgba(30,41,59,0.8);
            border: 1px solid rgba(148,163,184,0.4);
            color: #e5e7eb;
        }

        .form-control::placeholder {
            color: #94a3b8;
        }

        .form-control:focus,
        .form-select:focus {
            background: rgba(30,41,59,1);
            border-color: #4f46e5;
            box-shadow: 0 0 0 0.15rem rgba(79,70,229,0.4);
            color: #f1f5f9;
        }

        /* buttons */
        .btn-primary {
            background: linear-gradient(135deg, #4f46e5, #06b6d4);
            border: none;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #4338ca, #0891b2);
        }

        /* badges (ALLOW/FLAG/BLOCK) */
        .badge-decision { padding: 0.4rem 1rem; border-radius: 50px; font-size: 1rem; }
        .badge-allow { background-color: #16a34a; }
        .badge-flag { background-color: #f59e0b; color: #000; }
        .badge-block { background-color: #dc2626; }

        .info-pill {
            background: rgba(30,64,175,0.25);
            border: 1px solid rgba(129,140,248,0.6);
            padding: 0.4rem 0.7rem;
            font-size: 0.8rem;
            border-radius: 999px;
            color: #c7d2fe !important;
        }

        /* Make RISK SCORE (0‚Äì100) number bright & visible */
.result-value {
    color: #f8fafc !important;   /* bright white */
    font-size: 2rem !important;  /* slightly larger */
    font-weight: 800 !important; /* bold for visibility */
}


        /* Right-side card */
        .result-panel {
            border: 1px solid rgba(148,163,184,0.4);
            border-radius: 14px;
            background: rgba(15,23,42,0.8);
        }

        nav {
            background:#020617 !important;
            border-bottom: 1px solid rgba(148,163,184,0.3);
        }

    </style>
</head>

<body>

<nav class="navbar navbar-dark navbar-expand-lg">
    <div class="container-fluid">
        <a class="navbar-brand" href="/">
            <span class="fw-bold text-white">UPI Fraud Guardian</span>
            <small class="text-muted ms-2">AI-Powered</small>
        </a>

        <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#nav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div id="nav" class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item px-2">
                    <a class="nav-link active fw-semibold" href="/">
                        <i class="bi bi-shield-check me-1"></i>Predict Transaction
                    </a>
                </li>
                <li class="nav-item px-2">
                    <a class="nav-link fw-semibold" href="/dashboard">
                        <i class="bi bi-graph-up-arrow me-1"></i>Analytics Dashboard
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>


<div class="container my-5">

    <div class="card card-main p-4 p-lg-5">

        <div class="row g-5">

            <!-- Left: Input Form -->
            <div class="col-lg-7 border-end border-secondary">

                <h4 class="text-white fw-bold mb-2">Enter Transaction Details</h4>
                <p class="text-muted mb-3">
                    Fill the complete details of a UPI transaction. The AI engine evaluates behaviour,
                    context and patterns to determine if it is <strong>safe</strong>, <strong>suspicious</strong>,
                    or <strong>high-risk</strong>.
                </p>

                <form method="POST" action="/">

                    <!-- BASIC INFO -->
                    <div class="form-section-title">Basic Information</div>

                    <div class="mb-3">
                        <label class="form-label">Amount (‚Çπ)</label>
                        <input type="number" class="form-control"
                               name="amount" value="{{ form.amount }}" placeholder="Example: 1500">
                        <div class="label-help">Amount being transferred in rupees.</div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Hour of Day (0‚Äì23)</label>
                            <input type="number" min="0" max="23" class="form-control"
                                   name="hour_of_day" value="{{ form.hour_of_day }}"
                                   placeholder="23 = 11 PM">
                            <div class="label-help">24-hour format.</div>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label">Day of Week (0‚Äì6)</label>
                            <input type="number" min="0" max="6" class="form-control"
                                   name="day_of_week" value="{{ form.day_of_week }}">
                            <div class="label-help">0 = Monday, 6 = Sunday.</div>
                        </div>
                    </div>

                    <!-- CONTEXT -->
                    <div class="form-section-title">Context</div>

                    <div class="mb-3">
                        <label class="form-label">Location</label>
                        <select name="location" class="form-select">
                            {% for c in ["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand", "Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab",
 "Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura", "Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu", "Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"] %}
                                <option value="{{c}}" {% if form.location==c %}selected{% endif %}>{{c}}</option>
                            {% endfor %}
                        </select>
                        <div class="label-help">City where transaction is performed.</div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Transaction Type</label>
                        <select name="txn_type" class="form-select">
                            <option value="P2P" {% if form.txn_type=='P2P' %}selected{% endif %}>P2P ‚Äì Person to Person</option>
                            <option value="Merchant" {% if form.txn_type=='Merchant' %}selected{% endif %}>Merchant</option>
                            <option value="Bill" {% if form.txn_type=='Bill' %}selected{% endif %}>Bill Payments</option>
                            <option value="QR_Scan" {% if form.txn_type=='QR_Scan' %}selected{% endif %}>QR Scan</option>
                        </select>
                    </div>

                    <!-- Behaviour -->
                    <div class="form-section-title">Behaviour & History</div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Is New Device?</label>
                            <select class="form-select" name="is_new_device">
                                <option value="0" {% if form.is_new_device=="0" %}selected{% endif %}>No</option>
                                <option value="1" {% if form.is_new_device=="1" %}selected{% endif %}>Yes</option>
                            </select>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label">Is New Receiver?</label>
                            <select class="form-select" name="is_new_receiver">
                                <option value="0" {% if form.is_new_receiver=="0" %}selected{% endif %}>No</option>
                                <option value="1" {% if form.is_new_receiver=="1" %}selected{% endif %}>Yes</option>
                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Txn Last 1 Hour</label>
                            <input type="number" class="form-control"
                                   name="num_txn_last_1hr" value="{{ form.num_txn_last_1hr }}">
                        </div>

                        <div class="col-md-4 mb-3">
                            <label class="form-label">Txn Last 24 Hours</label>
                            <input type="number" class="form-control"
                                   name="num_txn_last_24hr" value="{{ form.num_txn_last_24hr }}">
                        </div>

                        <div class="col-md-4 mb-3">
                            <label class="form-label">Avg Amount (7 days)</label>
                            <input type="number" class="form-control"
                                   name="avg_amount_last_week" value="{{ form.avg_amount_last_week }}">
                        </div>
                    </div>

                    <button class="btn btn-primary btn-lg w-100 mt-2">Analyse Transaction</button>

                    <div class="label-help mt-2">
                        This is a demo using a synthetic dataset. Real UPI systems 
                        evaluate hundreds of signals in real-time.
                    </div>
                </form>

            </div>


            <!-- Right Panel -->
            <div class="col-lg-5">

                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5 class="fw-bold text-white">Prediction Result</h5>
                    <span class="info-pill">
                        <i class="bi bi-cpu"></i> Random Forest (offline trained)
                    </span>
                </div>

                <div class="p-4 result-panel">

                    <div class="mb-4">
                        <div class="small fw-semibold text-uppercase">Fraud Probability</div>
                        <div class="result-value text-info">
                            {{ result.proba | default("0.0") }} %
                        </div>
                        <div class="label-help">Values above 80% are considered highly suspicious.</div>
                    </div>

                    <hr>

                    <div class="mb-4">
                        <div class="small fw-semibold text-uppercase">Risk Score (0‚Äì100)</div>
                        <div class="result-value">
                            {{ result.risk_score | default(0) }}
                        </div>
                        <div class="label-help">0‚Äì40 safe, 41‚Äì70 needs review, 71‚Äì100 high-risk.</div>
                    </div>

                    <hr>

                    <div>
                        <div class="small fw-semibold text-uppercase">System Decision</div>
                        {% set d = result.decision | default("ALLOW") %}

                        {% if d == "ALLOW" %}
                            <span class="badge badge-decision badge-allow">
                                <i class="bi bi-check-circle"></i> ALLOW
                            </span>
                        {% elif d == "FLAG" %}
                            <span class="badge badge-decision badge-flag">
                                <i class="bi bi-flag-fill"></i> FLAG
                            </span>
                        {% else %}
                            <span class="badge badge-decision badge-block">
                                <i class="bi bi-shield-x"></i> BLOCK
                            </span>
                        {% endif %}
                    </div>

                    <div class="label-help mt-2">
                        ML + rule-based engine considers amount, behaviour, timing, device, and more.
                    </div>

                </div>

            </div>

        </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>

